fragment ChatMessageFields on Message {
  id
  roomId
  user
  to
  content
  createdAt
}

query GetMessages($roomId: String!) {
  messages(roomId: $roomId) {
    ...ChatMessageFields
  }
}

mutation PostMessage($roomId: String!, $user: String!, $to: String!, $content: String!) {
  postMessage(roomId: $roomId, user: $user, to: $to, content: $content) {
    ...ChatMessageFields
  }
}

subscription OnNewMessage($roomId: String!) {
  messageAdded(roomId: $roomId) {
    ...ChatMessageFields
  }
}

# NEW: Operation to listen on Home Page
subscription ListenToIncomingMessages($user: String!) {
  messageSentToUser(user: $user) {
    ...ChatMessageFields
  }
}
subscription OnMessageSentToUser($user: String!) {
  messageSentToUser(user: $user) {
    id
    content
    user # The sender
    createdAt
  }
}